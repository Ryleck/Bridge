/**
 * Created by Phil on 2016-02-09.
 */
var tableau = require('../tableau/tableau');

module.exports = {
    toXMLString: function(){
        var sXML = parseTableau();
        return sXML;
    }
};

function parseTableau(){
    var tableauXML = '<partie><feuille>';
    var ligneNoms1 = tableau.retourneTableauLigne(0);
    var ligneNoms2 = tableau.retourneTableauLigne(1);
    var ligneEquipes = tableau.retourneTableauLigne(2);
    var ligneJeu = '';

    tableauXML = tableauXML + '<noms>';

    tableauXML = tableauXML + '<nom1>';
    for(i = 0; i < ligneNoms1.length; i++){
        tableauXML = tableauXML + '<nom>' + ligneNoms1[i] + '</nom>';
    }
    tableauXML = tableauXML + '</nom1>';

    tableauXML = tableauXML + '<nom2>';
    for(i = 0; i < ligneNoms2.length; i++){
        tableauXML = tableauXML + '<nom>' + ligneNoms2[i] + '</nom>';
    }
    tableauXML = tableauXML + '</nom2>';

    tableauXML = tableauXML + '</noms>';

    tableauXML = tableauXML + '<equipes>';
    for(i = 0; i < ligneEquipes.length; i++){
        tableauXML = tableauXML + '<equipe>' + ligneEquipes[i] + '</equipe>';
    }
    tableauXML = tableauXML + '</equipes>';

    tableauXML = tableauXML + '<jeux>';

    for(i = 3; i < (parseInt(tableau.retourneNombrePlanchette())+3); i++){
        ligneJeu = tableau.retourneTableauLigne(i);
        tableauXML = tableauXML + '<jeu>';
        tableauXML = tableauXML + '<planchette>' + tableau.retourneTableauPosition(i, 0) + '</planchette>';
        for(j = 1; j < ligneJeu.length; j++){
            tableauXML = tableauXML + '<score>' + ligneJeu[j] + '</score>';
        }
        tableauXML = tableauXML + '</jeu>';
    }

    tableauXML = tableauXML + '</jeux>';

    tableauXML = tableauXML + '</feuille> ';

    tableauXML = tableauXML + '<stats>';

    tableauXML = tableauXML + '<nbEquipes>' + tableau.retourneNombreDEquipe() + '</nbEquipes>';
    tableauXML = tableauXML + '<nbPlanchettes>' + tableau.retourneNombrePlanchette() + '</nbPlanchettes>';
    tableauXML = tableauXML + '<nbRondes>' + tableau.retourneNombreRondes() + '</nbRondes>';
    tableauXML = tableauXML + '<score>' + tableau.retourneTypeScore() + '</score>';
    tableauXML = tableauXML + '<phantome>' + tableau.retournePhantome() + '</phantome>';
    tableauXML = tableauXML + '<fini>' + tableau.retourneFini() + '</fini>';

    tableauXML = tableauXML + '</stats>';

    tableauXML = tableauXML + '</partie> ';
    return tableauXML;
}